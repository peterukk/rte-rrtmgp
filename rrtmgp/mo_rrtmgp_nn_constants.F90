! This code is part of RRTM for GCM Applications - Parallel - Neural Network (RRTMGP-NN)
!
! RRTMGP contacts and email: Robert Pincus and Eli Mlawer
! rrtmgp@aer.com
!
! Copyright 2015-2018,  Atmospheric and Environmental Research and
! Regents of the University of Colorado.  All right reserved.
!
! Use and duplication is permitted under the terms of the
!    BSD 3-clause license, see http://opensource.org/licenses/BSD-3-Clause
! -------------------------------------------------------------------------------------------------
! Constants used for scaling inputs and outputs for neural network based RRTMGP emulators
! 
! Authors: Peter Ukkonen
!
! -------------------------------------------------------------------------------------------------
module mo_rrtmgp_nn_constants
    use mo_rte_kind, only: wp, sp
    public
  
    ! -----------------------------------------
    integer, parameter :: ninputs_all = 19
    ! Strings specifying all the RRTMGP gases which can be used by neural networks, these are matched to available gases
    character(32), dimension(ninputs_all) :: nn_gasopt_input_names = [character(len=32)  :: 'tlay', 'play', 'h2o',   'o3', 'co2',  &
    'n2o', 'ch4', 'cfc11', 'cfc12', 'co', 'ccl4', 'cfc22', 'hfc143a', 'hfc125', 'hfc23', 'hfc32', 'hfc134a', 'cf4', 'no2'] 

    ! Scaling coefficients for neural network inputs, used to scale values to between 0 and 1 (min-max-scaling)
    ! Furthermore, some inputs are power or log-scaled. The f irst two inputs are pressure and temperature, followed by gases.
    ! The inputs are:                                             tlay,   log(play), h2o**(1/4),o3**(1/4),co2, ... 
    real(sp), dimension(ninputs_all)   :: nn_input_minvals =  (/ 1.60E2, 5.15E-3,   1.01E-2,   4.36E-3,  1.41E-4, 0.00E0, 2.55E-8, 0.00E0, 0.00E0, &
    0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0, 0.00E0 /)
    real(sp), dimension(ninputs_all)   :: nn_input_maxvals =  (/ 3.2047600E2, 1.1550600E1, 5.0775300E-1, 6.3168340E-2, 2.3000003E-3, 5.8135214E-7, & 
    3.6000001E-6, 2.0000002E-9, 5.3385213E-10, 1.3127458E-6, 1.0316801E-10, 2.3845328E-10, &
     7.7914392E-10, 9.8880004E-10, 3.1067642E-11, 1.3642075E-11, 4.2330001E-10, 1.6702625E-10, 3.0E-10 /)

    ! Scaling coefficients for neural network outputs (absorption/rayleigh cross-sections)
    ! To scale the g-point vectors, we use the mean of individual g-points but the sigma across all g-points
    ! This is a variant of standard scaling which preserves the correlations between outputs
     real(sp), parameter                 :: ysigma_lw_tau = 0.0008864219_sp
     real(sp), parameter, dimension(256) :: ymeans_lw_tau = (/ &
     0.0007013, 0.00081638, 0.00088407, 0.0009376, 0.00100272,  0.00108871, 0.00119965, 0.00136057, 0.00162019, 0.00185225,&
     0.00195079, 0.00206555, 0.00220559, 0.00240607, 0.00271468,0.00301905, 0.00046654, 0.00051556, 0.00058341, 0.00065088,&
     0.00070464, 0.00076876, 0.00085896, 0.00097935, 0.00119935,0.00141034, 0.00151006, 0.00163442, 0.00180711, 0.00204042,&
     0.00242276, 0.00280669, 0.00042887, 0.00046485, 0.00051584,0.00058201, 0.00065572, 0.00072477, 0.00080584, 0.00091423,&
     0.00110042, 0.00127067, 0.00134649, 0.00144005, 0.00155864,0.0017359, 0.00192395, 0.00202425, 0.00089971, 0.00101015,&
     0.0010735, 0.00113382, 0.00121697, 0.00131415, 0.0014548,0.00166414, 0.00201406, 0.0023286, 0.00248189, 0.0026516,&
     0.0028395, 0.00309552, 0.00329059, 0.00340846, 0.00040419,0.00044149, 0.00049501, 0.00057646, 0.00065665, 0.00072959,&
     0.0008178, 0.00092567, 0.00110577, 0.00127773, 0.00135464,0.00144639, 0.00155456, 0.00172624, 0.00195144, 0.00219249,&
     0.00037311, 0.00038832, 0.00039876, 0.00039357, 0.00039073,0.00039439, 0.00040139, 0.00041544, 0.00045041, 0.00048733,&
     0.00050021, 0.000511, 0.0005222, 0.00053226, 0.00053905,0.00053686, 0.00045033, 0.00050789, 0.00056031, 0.0006055,&
     0.00064596, 0.0006884, 0.00073842, 0.00080476, 0.00091462,0.00100837, 0.00104174, 0.00107803, 0.00112003, 0.00116588,&
     0.00121704, 0.00124574, 0.00043096, 0.00044609, 0.00045882,0.00047328, 0.00049173, 0.00051617, 0.00055129, 0.00060892,&
     0.00070759, 0.00078732, 0.00081574, 0.00084897, 0.00089626,0.00096228, 0.00103707, 0.00107244, 0.00044382, 0.00047923,&
     0.00052424, 0.00056825, 0.00061594, 0.00066949, 0.00073642,0.00083537, 0.00099988, 0.00115576, 0.00122428, 0.00130514,&
     0.0013967, 0.00150886, 0.00164095, 0.00173281, 0.0005398,0.00058346, 0.00061954, 0.00065103, 0.00069784, 0.00076837,&
     0.00086104, 0.00099005, 0.00119531, 0.00135744, 0.00142613,0.00151644, 0.00163775, 0.0017866, 0.00194151, 0.00203961,&
     0.00062092, 0.00068568, 0.00072482, 0.00076629, 0.00081684,0.00088733, 0.00098261, 0.00111583, 0.00132001, 0.00149657,&
     0.00157718, 0.00167974, 0.00181246, 0.00196578, 0.00211621,0.00222501, 0.00027775, 0.00031307, 0.00034595, 0.00037792,&
     0.00040985, 0.00044745, 0.00049738, 0.00056636, 0.00068384,0.00079073, 0.00083684, 0.00089007, 0.00094933, 0.00101663,&
     0.00109136, 0.00115981, 0.00041082, 0.00047212, 0.0005221,0.00057267, 0.00062689, 0.00068311, 0.00074801, 0.00083137,&
     0.0009249, 0.00097404, 0.00098701, 0.0009677, 0.00091862,0.00092232, 0.00097919, 0.00099403, 0.00082178, 0.00097702,&
     0.00115414, 0.00134279, 0.00149137, 0.00160743, 0.00175431,0.00198898, 0.00242579, 0.00281907, 0.00299135, 0.00319233,&
     0.00345435, 0.00384145, 0.00410627, 0.00420549, 0.00022183,0.00025186, 0.00027004, 0.0002846, 0.0003047, 0.00032399,&
     0.00034067, 0.00035919, 0.00038545, 0.00040524, 0.00041355,0.00042393, 0.00043629, 0.00045243, 0.0004797, 0.00050912,&
     0.00030737, 0.00035681, 0.00039763, 0.00043568, 0.00047533,0.00052387, 0.00058468, 0.00066867, 0.00081455, 0.00094435,&
     0.00099829, 0.00107121, 0.00117441, 0.00127705, 0.00135903, 0.00142707 /) 
   
     real(sp), parameter                 :: ysigma_sw_tau_ray = 0.00019679657
     real(sp), parameter, dimension(224) :: ymeans_sw_tau_ray = (/ &
     0.00016408, 0.00016821, 0.00016852, 0.00016616, 0.0001631 ,0.0001615 , 0.00016211, 0.00016632, 0.00017432, 0.00017609,&
     0.00017617, 0.00017683, 0.00017806, 0.00017891, 0.00017938,0.00017905, 0.00020313, 0.000203  , 0.00020417, 0.00020546,&
     0.00020597, 0.00020647, 0.0002067 , 0.0002069 , 0.00020719,0.00020752, 0.00020766, 0.00020783, 0.00020801, 0.00020828,&
     0.00020884, 0.00020988, 0.00022147, 0.00022575, 0.00022777,0.00022846, 0.00022824, 0.00022803, 0.00022816, 0.00022841,&
     0.0002286 , 0.00022876, 0.00022883, 0.00022887, 0.00022888,0.00022891, 0.00022922, 0.00023004, 0.00025017, 0.00024942,&
     0.00024824, 0.00024734, 0.00024655, 0.00024587, 0.00024539,0.00024486, 0.00024454, 0.0002441 , 0.00024381, 0.00024343,&
     0.00024307, 0.00024265, 0.00024179, 0.00024042, 0.00025942,0.00026145, 0.00026296, 0.00026379, 0.00026454, 0.00026518,&
     0.00026548, 0.00026566, 0.00026578, 0.00026592, 0.00026607,0.00026617, 0.00026612, 0.00026633, 0.00026634, 0.00026667,&
     0.00028838, 0.00028652, 0.00028487, 0.00028311, 0.00027978,0.00027901, 0.00027885, 0.00027866, 0.000278  , 0.00027733,&
     0.00027734, 0.00027694, 0.00027574, 0.00027526, 0.0002754 ,0.00027594, 0.00030356, 0.00031213, 0.00031563, 0.00031476,&
     0.00031548, 0.00031693, 0.00031758, 0.00031764, 0.00031757,0.00031747, 0.0003175 , 0.0003176 , 0.00031767, 0.00031787,&
     0.00031921, 0.00032022, 0.00033161, 0.00033401, 0.00033486,0.0003345 , 0.00033421, 0.00033408, 0.00033402, 0.00033377,&
     0.00033366, 0.00033365, 0.0003337 , 0.0003337 , 0.00033372,0.00033368, 0.0003336 , 0.00033342, 0.00038102, 0.00038465,&
     0.00038598, 0.00038884, 0.00039175, 0.00039174, 0.00039248,0.00039248, 0.00039339, 0.00038445, 0.00037872, 0.00037472,&
     0.00037253, 0.00036779, 0.00036238, 0.00035383, 0.0004347 ,0.00044431, 0.00045121, 0.00045676, 0.00046053, 0.00046292,&
     0.00046443, 0.00046354, 0.00045597, 0.0004476 , 0.00044526,0.00044227, 0.00043994, 0.00043726, 0.00043139, 0.00043131,&
     0.00050991, 0.0005198 , 0.00052429, 0.00052806, 0.00052854,0.00052917, 0.00053388, 0.00053857, 0.0005396 , 0.00053686,&
     0.00053488, 0.0005327 , 0.00052904, 0.00052511, 0.00052043,0.00051689, 0.00057637, 0.0005886 , 0.0006002 , 0.00061095,&
     0.00062064, 0.00062908, 0.00063611, 0.00064162, 0.00064557,0.00064733, 0.00064765, 0.0006479 , 0.0006481 , 0.00064824,&
     0.00064831, 0.00064833, 0.00065669, 0.00067188, 0.00068705,0.00070096, 0.00071349, 0.00072444, 0.00073358, 0.00074076,&
     0.00074614, 0.00074835, 0.00074795, 0.00074786, 0.0007479 ,0.00074804, 0.00074818, 0.00074823, 0.0008143 , 0.00081451,&
     0.00081412, 0.00081407, 0.00081408, 0.00081299, 0.00081158,0.00081498, 0.00081472, 0.0008145 , 0.00081539, 0.00081426,&
     0.00081398, 0.000814  , 0.00081404, 0.00081415 /)   
   
     real(sp), parameter                 :: ysigma_sw_tau_abs = 0.00065187697
     real(sp), parameter, dimension(224) :: ymeans_sw_tau_abs = (/ &
     3.64390580e-4, 4.35663940e-4, 4.98018635e-4, 5.77545608e-4, 6.80800469e-4, 7.98740832e-4, 9.35279648e-4, 1.16656872e-3,&
     1.58452173e-3, 1.86584354e-3, 1.99465151e-3, 2.16701976e-3, 2.41802959e-3, 2.82146805e-3, 3.48183908e-3, 4.09035478e-3,&
     3.24113556e-4, 3.74707161e-4, 4.17389121e-4, 4.57456830e-4, 4.98836453e-4, 5.49621007e-4, 6.13025972e-4, 7.00094330e-4,&
     8.49446864e-4, 9.81244841e-4, 1.03521883e-3, 1.10830076e-3, 1.21134310e-3, 1.31195760e-3, 1.39195414e-3, 1.45876186e-3,&
     4.28469037e-4, 5.20646572e-4, 6.22550666e-4, 7.22033263e-4, 8.23189737e-4, 9.40993312e-4, 1.06700219e-3, 1.21110224e-3,&
     1.45994173e-3, 1.69180706e-3, 1.79443962e-3, 1.92319078e-3, 2.08631344e-3, 2.33873748e-3, 2.59446981e-3, 2.72375043e-3,&
     2.89453164e-4, 3.26674141e-4, 3.59543861e-4, 3.93101625e-4, 4.30800777e-4, 4.71213047e-4, 5.19042369e-4, 5.83244429e-4,&
     6.85371691e-4, 7.79234222e-4, 8.19451292e-4, 8.65648268e-4, 9.23064887e-4, 1.00047945e-3, 1.08587136e-3, 1.09644048e-3,&
     2.97961291e-4, 3.59470578e-4, 4.12600290e-4, 4.63586446e-4, 5.14341518e-4, 5.67600771e-4, 6.28228823e-4, 7.09333457e-4,&
     8.51527497e-4, 9.86502739e-4, 1.04738004e-3, 1.12565351e-3, 1.23939372e-3, 1.37201988e-3, 1.52829266e-3, 1.63304247e-3,&
     2.70115474e-4, 3.13259574e-4, 3.55943455e-4, 4.24126105e-4, 5.12095110e-4, 5.70286124e-4, 6.33014424e-4, 7.20241107e-4,&
     8.71218799e-4, 1.01254229e-3, 1.07443938e-3, 1.14905764e-3, 1.24553905e-3, 1.37227518e-3, 1.50288385e-3, 1.59471075e-3,&
     2.49097910e-4, 3.04214394e-4, 3.61522223e-4, 4.22842306e-4, 4.84134798e-4, 5.45158167e-4, 6.10073039e-4, 6.93159061e-4,&
     8.35262705e-4, 9.70904832e-4, 1.03256141e-3, 1.10617711e-3, 1.19320781e-3, 1.30544091e-3, 1.43013091e-3, 1.53011072e-3,&
     3.03399313e-4, 3.29578412e-4, 3.45331355e-4, 3.61360639e-4, 3.78781464e-4, 3.96694435e-4, 4.13389760e-4, 4.41241835e-4,&
     5.20797505e-4, 6.10202318e-4, 6.68037275e-4, 7.32506509e-4, 7.93701038e-4, 8.53195263e-4, 9.09500406e-4, 9.46514192e-4,&
     2.32592269e-4, 2.71835335e-4, 3.08167830e-4, 3.44223663e-4, 3.79800709e-4, 4.20017983e-4, 4.63830249e-4, 5.07036340e-4,&
     5.73535392e-4, 6.31669944e-4, 6.62838283e-4, 7.10128399e-4, 7.75139430e-4, 8.65899900e-4, 9.70544817e-4, 1.06985983e-3,&
     3.41864652e-4, 3.69071873e-4, 3.96323914e-4, 4.22754820e-4, 4.46886756e-4, 4.71655425e-4, 4.98428126e-4, 5.32940670e-4,&
     6.06888614e-4, 6.70523092e-4, 7.07189436e-4, 7.71613559e-4, 8.81720975e-4, 1.09840697e-3, 1.38371368e-3, 1.53473706e-3,&
     4.17014409e-4, 4.30032291e-4, 4.34701447e-4, 4.33250068e-4, 4.38496791e-4, 4.55915550e-4, 4.31207794e-4, 4.22994781e-4,&
     4.37038223e-4, 4.48761188e-4, 4.56356967e-4, 4.66349302e-4, 4.80149902e-4, 4.99643327e-4, 5.27186319e-4, 5.57484163e-4,&
     2.16507342e-5, 2.14800675e-5, 2.42409842e-5, 2.30929109e-5, 2.50050962e-5, 2.49029163e-5, 2.54020069e-5, 2.31895119e-5,&
     2.51217079e-5, 2.50334833e-5, 2.48085526e-5, 2.50862649e-5, 2.36565447e-5, 2.40919053e-5, 2.22349281e-5, 2.54304305e-5,&
     4.07712301e-4, 5.41551271e-4, 6.77760807e-4, 8.20003042e-4, 9.50566900e-4, 1.05036958e-3, 1.11506274e-3, 1.15274324e-3,&
     1.17376540e-3, 1.18031248e-3, 1.18122390e-3, 1.18179375e-3, 1.18207792e-3, 1.18228467e-3, 1.18242903e-3, 1.18247792e-3,&
     1.02293247e-3, 1.05753809e-3, 1.11542153e-3, 1.18556281e-3, 1.24850264e-3, 1.29191973e-3, 1.30981358e-3, 1.31571468e-3,&
     1.31824624e-3, 1.31927885e-3, 1.31954963e-3, 1.31999550e-3, 1.32057443e-3, 1.32077874e-3, 1.32089714e-3, 1.32086105e-3 /)
  
  end module mo_rrtmgp_nn_constants
  